# 测试指南

## 服务访问地址

- **前端应用**: http://localhost:5173
- **后端 API**: http://localhost:8000
- **API 文档**: http://localhost:8000/docs

## 功能测试清单

### 1. 基础对话功能 ✅
- [ ] 发送简单查询（如："AAPL 现在多少钱？"）
- [ ] 查看响应是否正常
- [ ] 检查响应时间

### 2. 市场指数识别 ✅
- [ ] 输入"纳斯达克最近如何"
- [ ] 验证系统是否正确识别为 `^IXIC`
- [ ] 检查是否返回了正确的数据

### 3. Tavily Search 集成 ✅
- [ ] 输入需要搜索的查询（如："搜索一下特斯拉最新新闻"）
- [ ] 检查是否返回了 AI 摘要
- [ ] 验证搜索结果是否包含相关性评分

### 4. 图表生成功能
- [ ] 询问价格变化（如："AAPL 最近的价格走势"）
- [ ] 检查是否自动生成了图表
- [ ] 验证图表类型是否正确（K线图、折线图等）
- [ ] 测试不同时间周期（日、周、月、年）

### 5. 对话体验
- [ ] 输入"分析一下特斯拉"
- [ ] 检查是否先询问确认问题（而不是直接生成报告）
- [ ] 验证多轮对话是否正常

### 6. 图表面板功能
- [ ] 测试图表面板的展开/收起功能
- [ ] 验证收起图表时，聊天窗口是否正确扩展
- [ ] 检查生成图表时是否自动展开面板

### 7. 设置功能
- [ ] 点击设置按钮
- [ ] 检查是否可以配置 API Keys
- [ ] 验证 LLM 配置选项

### 8. Agent 引导
- [ ] 检查欢迎消息是否包含功能介绍
- [ ] 验证示例查询是否清晰

## 测试场景示例

### 场景 1: 简单价格查询
```
用户: "AAPL 现在多少钱？"
预期: 返回当前价格和涨跌幅
```

### 场景 2: 市场指数查询
```
用户: "纳斯达克最近如何"
预期: 
- 正确识别为 ^IXIC
- 返回价格信息
- 可能生成图表
```

### 场景 3: 新闻搜索（Tavily）
```
用户: "搜索一下特斯拉最新新闻"
预期:
- 使用 Tavily Search
- 返回 AI 摘要
- 显示结构化搜索结果
```

### 场景 4: 报告生成
```
用户: "分析一下特斯拉"
预期:
- 先询问确认问题
- 然后生成详细报告
- 包含多个数据源的信息
```

### 场景 5: 图表生成
```
用户: "AAPL 最近的价格走势"
预期:
- 自动生成图表
- 图表面板自动展开
- 图表嵌入到聊天历史中
```

## 常见问题排查

### 前端无法访问
1. 检查前端是否在运行：`npm run dev` (在 frontend 目录)
2. 检查端口 5173 是否被占用
3. 查看浏览器控制台错误

### 后端 API 无响应
1. 检查后端是否在运行：查看终端输出
2. 访问 http://localhost:8000/docs 查看 API 文档
3. 检查后端日志中的错误信息

### 搜索功能不工作
1. 检查 `TAVILY_API_KEY` 是否配置
2. 查看后端日志，确认是否使用了 Tavily
3. 如果没有 API Key，应该自动回退到 DuckDuckGo

### 图表不显示
1. 检查浏览器控制台是否有错误
2. 验证后端 `/api/stock/kline/{ticker}` 端点是否正常
3. 检查数据源是否可用（可能有速率限制）

## 性能检查

- 响应时间：一般查询应在 2-5 秒内
- 报告生成：应在 30-60 秒内
- 图表加载：应在 1-3 秒内

## 浏览器兼容性

建议使用以下浏览器：
- Chrome (最新版本)
- Edge (最新版本)
- Firefox (最新版本)

## 注意事项

1. **API 限制**: 某些数据源有速率限制，如果遇到错误，等待一段时间后重试
2. **首次加载**: 前端首次加载可能需要一些时间编译
3. **热重载**: 修改代码后，前端会自动刷新

## 测试完成标准

- ✅ 所有基础功能正常
- ✅ 对话流畅，响应及时
- ✅ 图表生成正常
- ✅ 搜索功能正常（Tavily）
- ✅ 市场指数识别正确
- ✅ UI 交互正常

